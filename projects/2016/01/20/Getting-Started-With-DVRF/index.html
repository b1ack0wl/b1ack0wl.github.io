<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Getting Started with DVRF &vert; b1ack0wl</title>
<meta name="description" content="security research">
<meta name="keywords" content="Projects">


<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://b1ack0wl.com/images/">
<meta name="twitter:title" content="Getting Started with DVRF">
<meta name="twitter:description" content="security research">
<meta name="twitter:creator" content="@b1ack0wl">


<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Getting Started with DVRF">
<meta property="og:description" content="security research">
<meta property="og:url" content="http://b1ack0wl.com/projects/2016/01/20/Getting-Started-With-DVRF/">
<meta property="og:site_name" content="b1ack0wl">
<meta property="og:image" content="http://b1ack0wl.com/images/">





<link rel="canonical" href="http://b1ack0wl.com/projects/2016/01/20/Getting-Started-With-DVRF/">
<link href="http://b1ack0wl.com/feed.xml" type="application/atom+xml" rel="alternate" title="b1ack0wl Feed">



<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />


    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://b1ack0wl.com/assets/css/vendor/font-awesome.min.css">
    <link rel="stylesheet" href="http://b1ack0wl.com/assets/css/vendor/normalize.css">
    <link rel="stylesheet" href="http://b1ack0wl.com/assets/css/vendor/nprogress.css">
    <link rel="stylesheet" href="http://b1ack0wl.com/assets/css/vendor/foundation.min.css">
    <link rel="stylesheet" href="http://b1ack0wl.com/assets/css/style.css">
    <link rel="stylesheet" href="http://b1ack0wl.com/assets/css/post.css">






<link rel="shortcut icon" href="http://b1ack0wl.com/favicon.ico">
<link rel="shortcut icon" href="http://b1ack0wl.com/favicon.png">
<link rel="apple-touch-icon-precomposed" href="http://b1ack0wl.com/images/apple-touch-icon-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://b1ack0wl.com/images/apple-touch-icon-72x72-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://b1ack0wl.com/images/apple-touch-icon-114x114-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://b1ack0wl.com/images/apple-touch-icon-144x144-precomposed.png">

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float:left;font-size:4.688rem;line-height:4.375rem;padding-top:.25rem;padding-right:.5rem;padding-left:.188rem;font-family:serif}}</style>
</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">

        <main id="notepad-post-container-simple" class="notepad-post-container-simple" role="main">
            <header class="notepad-post-header-simple">
                <div class="notepad-post-menu-header-simple">


                <div class="notepad-blog-menu">
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="http://b1ack0wl.com/">Home</a>
                 </li>

            <li>
                    <a href="http://b1ack0wl.com/categories">Categories</a>
                 </li>

            <li>
                    <a href="http://b1ack0wl.com/about">About</a>
                 </li>

           <li><a href="http://b1ack0wl.com/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

                <div class="notepad-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="notepad-post-meta-simple">
                            <h1>Getting Started with DVRF</h1>
                            <p>by <strong>b1ack0wl</strong> &#8212; on <a href="http://b1ack0wl.com/tags/index.html#Projects" data-toggle="tooltip" title="Posts tagged with Projects" rel="tag">Projects</a> <strong><time datetime="2016-01-20T22:32:00+05:30">20 Jan 2016</time></strong></p>
                        </div>
                    </div>
                </div>
            </header>

        <article class="notepad-post-content post tag-simple">
            <div><p>So now that v0.1 has been released for <a href="https://github.com/praetorian-inc/DVRF">DVRF</a> I wanted to make this post to help people get started with DVRF even if they don’t have a E1550 in hand. For this post we’ll be going over how to use DVRF with <a href="http://wiki.qemu.org/Main_Page">QEMU.</a> To get started you’ll need to do the following:</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF <span class="nv">$ </span>sudo apt-get install qemu-user-static
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following NEW packages will be installed:
  qemu-user-static
<span class="m">0</span> upgraded, <span class="m">1</span> newly installed, <span class="m">0</span> to remove and <span class="m">25</span> not upgraded.
Need to get <span class="m">0</span> B/7,795 kB of archives.
After this operation, 79.4 MB of additional disk space will be used.
Selecting previously unselected package qemu-user-static.
<span class="o">(</span>Reading database ... <span class="m">173955</span> files and directories currently installed.<span class="o">)</span>
Preparing to unpack .../qemu-user-static_2.0.0+dfsg-2ubuntu1.21_amd64.deb ...
Unpacking qemu-user-static <span class="o">(</span>2.0.0+dfsg-2ubuntu1.21<span class="o">)</span> ...
Processing triggers <span class="k">for</span> man-db <span class="o">(</span>2.6.7.1-1ubuntu1<span class="o">)</span> ...
Setting up qemu-user-static <span class="o">(</span>2.0.0+dfsg-2ubuntu1.21<span class="o">)</span> ...
b1ack0wl@b1ack0wl-VM ~/DVRF <span class="err">$</span></code></pre></div>

<p>Once you have <strong>qemu-user-static</strong> installed you’ll next want to install <a href="https://github.com/devttys0/binwalk">Binwalk.</a> Make sure to follow the instructions so that you have all of the dependancies needed to extract the squash-fs within the DVRF binary. Once <strong>Binwalk</strong> is installed you will also want to download the uClibc <a href="https://buildroot.org/">Buildroot</a> tar file. This is crucial since this is going to be your bread and butter for cross compiling and also debugging especially if you don’t have IDA. To get started do the following:</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF <span class="nv">$ </span>wget https://buildroot.org/downloads/buildroot-2015.11.1.tar.gz
--2016-01-20 22:53:34--  https://buildroot.org/downloads/buildroot-2015.11.1.tar.gz
Resolving buildroot.org <span class="o">(</span>buildroot.org<span class="o">)</span>... 140.211.167.224
Connecting to buildroot.org <span class="o">(</span>buildroot.org<span class="o">)</span><span class="p">|</span>140.211.167.224<span class="p">|</span>:443... connected.
HTTP request sent, awaiting response... <span class="m">200</span> OK
Length: <span class="m">5460407</span> <span class="o">(</span>5.2M<span class="o">)</span> <span class="o">[</span>application/x-gzip<span class="o">]</span>
Saving to: ‘buildroot-2015.11.1.tar.gz’

100%<span class="o">[======================================</span>&gt;<span class="o">]</span> 5,460,407   87.5KB/s   in 57s    

2016-01-20 22:54:33 <span class="o">(</span>92.7 KB/s<span class="o">)</span> - ‘buildroot-2015.11.1.tar.gz’ saved <span class="o">[</span>5460407/5460407<span class="o">]</span>

b1ack0wl@b1ack0wl-VM ~/DVRF <span class="nv">$ </span>tar xzf buildroot-2015.11.1.tar.gz
b1ack0wl@b1ack0wl-VM ~/DVRF <span class="nv">$ </span><span class="nb">cd </span>buildroot-2015.11.1/

b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1 <span class="nv">$ </span>ls
arch   build      Config.in.legacy  docs   Makefile         README   toolchain
board  CHANGES    configs           fs     Makefile.legacy  support
boot   Config.in  COPYING           linux  package          system</code></pre></div>

<p>Now you’re going to type <strong>make menuconfig</strong> and when it’s done you’re going to see the following:</p>

<p><img src="http://b1ack0wl.com/assets/img/dvrf-buildroot-make-menuconfig.jpg" alt="make menuconfig" /></p>

<p>Under <strong>Target</strong> you’re going to select MIPS little endian, ELF, and mips32. Soft float can be enabled since for now it doesn’t matter for the exercises I have under /pwnables.</p>

<p><img src="http://b1ack0wl.com/assets/img/dvrf-buildroot-make-menuconfig-target.jpg" alt="CPU Architecture" /></p>

<p>Under <strong>Toolkit</strong> you’ll want to set the C Library to uClibc since the binary is compiled with this library and most devices you’ll come across will be using this C library.</p>

<p><img src="http://b1ack0wl.com/assets/img/dvrf-buildroot-make-menuconfig-toolkit-uclibc.jpg" alt="uClibc Library" /></p>

<p>Also under <strong>Toolkit</strong> you’ll want to enable “Build cross gdb for the host.” This will create a gdb binary that will run on your host (e.g. x86_64) but will support your target Architecture (e.g. MIPS). This is helpful for debugging applications when using the -g argument in Qemu.</p>

<p><img src="http://b1ack0wl.com/assets/img/dvrf-buildroot-make-menuconfig-toolkit.jpg" alt="GDB Support" /></p>

<p>Make sure to save your configuration changes so that your toolkit will compile for the right Architecture we’ve chosen.</p>

<p><img src="http://b1ack0wl.com/assets/img/dvrf-buildroot-make-menuconfig-toolkit-save.jpg" alt="Save" /></p>

<p>Now feel free to either explore what other options the toolkit can provide or exit the menu and type “make” but be warned that this process does take a while so it might be a good time to go grab a cup of coffee and also make sure you have an internet connection since this process will download tar files that are needed for compiling.</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1 <span class="nv">$ </span>make menuconfig


*** End of the configuration.
*** Execute <span class="s1">&#39;make&#39;</span> to start the build or try <span class="s1">&#39;make help&#39;</span>.

b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1 <span class="nv">$ </span>make
/usr/bin/make -j1  <span class="nv">HOSTCC</span><span class="o">=</span><span class="s2">&quot;/usr/bin/gcc&quot;</span> <span class="nv">HOSTCXX</span><span class="o">=</span><span class="s2">&quot;/usr/bin/g++&quot;</span> silentoldconfig
make<span class="o">[</span>1<span class="o">]</span>: Entering directory /home/b1ack0wl/DVRF/buildroot-2015.11.1<span class="err">&#39;</span>
mkdir -p /home/b1ack0wl/DVRF/buildroot-2015.11.1/output/build/buildroot-config/lxdialog
<span class="o">[</span>...Truncated...<span class="o">]</span></code></pre></div>

<p>Once the toolkit has finished compiling you’ll see a new folder called <strong>output</strong> this is where the toolkit compiled but for this we’ll only care about what’s been compiled into the host folder within output.</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1 <span class="nv">$ </span>ls
arch   build      Config.in.legacy  dl    linux            output   support
board  CHANGES    configs           docs  Makefile         package  system
boot   Config.in  COPYING           fs    Makefile.legacy  README   toolchain
b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1 <span class="nv">$ </span><span class="nb">cd </span>output/
b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1/output <span class="nv">$ </span>ls
build  host  images  staging  target
b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1/output <span class="nv">$ </span><span class="nb">cd </span>host/usr/
b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1/output/host/usr <span class="nv">$ </span>ls
bin  include  lib  libexec  mipsel-buildroot-linux-uclibc  share  x86_64-unknown-linux-gnu
b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1/output/host/usr <span class="nv">$ </span><span class="nb">cd </span>bin/
b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1/output/host/usr/bin <span class="nv">$ </span>ls *-build*
mipsel-buildroot-linux-uclibc-addr2line          mipsel-buildroot-linux-uclibc-gcov
mipsel-buildroot-linux-uclibc-ar                 mipsel-buildroot-linux-uclibc-gdb
mipsel-buildroot-linux-uclibc-as                 mipsel-buildroot-linux-uclibc-gprof
mipsel-buildroot-linux-uclibc-cc                 mipsel-buildroot-linux-uclibc-ld
mipsel-buildroot-linux-uclibc-cc.br_real         mipsel-buildroot-linux-uclibc-ld.bfd
mipsel-buildroot-linux-uclibc-c++filt            mipsel-buildroot-linux-uclibc-ldconfig
mipsel-buildroot-linux-uclibc-cpp                mipsel-buildroot-linux-uclibc-ldd
mipsel-buildroot-linux-uclibc-cpp.br_real        mipsel-buildroot-linux-uclibc-nm
mipsel-buildroot-linux-uclibc-elfedit            mipsel-buildroot-linux-uclibc-objcopy
mipsel-buildroot-linux-uclibc-gcc                mipsel-buildroot-linux-uclibc-objdump
mipsel-buildroot-linux-uclibc-gcc-4.9.3          mipsel-buildroot-linux-uclibc-ranlib
mipsel-buildroot-linux-uclibc-gcc-4.9.3.br_real  mipsel-buildroot-linux-uclibc-readelf
mipsel-buildroot-linux-uclibc-gcc-ar             mipsel-buildroot-linux-uclibc-size
mipsel-buildroot-linux-uclibc-gcc.br_real        mipsel-buildroot-linux-uclibc-strings
mipsel-buildroot-linux-uclibc-gcc-nm             mipsel-buildroot-linux-uclibc-strip
mipsel-buildroot-linux-uclibc-gcc-ranlib</code></pre></div>

<p>You can see that we have cross compilers and an instance of gdb. We will use this for crafting our exploits. Now that we have <strong>binwalk</strong>, <strong>buildroot</strong>, and <strong>qemu-user-static</strong> installed we can get started on the first pwnable within the Intro folder. First we need to extract the contents within the binary file. We will use <strong>binwalk</strong> to help us extract the binary with options -e for Extract and -M for Matryoshka which will extract recursively for up to 8 layers deep.</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF <span class="nv">$ </span>binwalk -eM ./DVRF_v01.bin

Scan Time:     2016-01-21 19:44:52
Target File:   /home/b1ack0wl/DVRF/DVRF_v01.bin
MD5 Checksum:  34dced9038b2d1e205b6c0f68991ccfe
Signatures:    343

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
<span class="m">0</span>             0x0             BIN-Header, board ID: 1550, hardware version: 4702, firmware version: 1.0.0, build date: 2012-02-08
<span class="m">32</span>            0x20            TRX firmware header, little endian, image size: <span class="m">7753728</span> bytes, CRC32: 0x97096BA6, flags: 0x0, version: 1, header size: <span class="m">28</span> bytes, loader offset: 0x1C, linux kernel offset: 0x192704, rootfs offset: 0x0
<span class="m">60</span>            0x3C            gzip compressed data, maximum compression, has original file name: <span class="s2">&quot;piggy&quot;</span>, from Unix, last modified: 2015-12-31 10:44:22
<span class="m">1648420</span>       0x192724        Squashfs filesystem, little endian, non-standard signature, version 3.0, size: <span class="m">6099526</span> bytes, <span class="m">447</span> inodes, blocksize: <span class="m">65536</span> bytes, created: 2016-01-19 01:47:20
<span class="o">[</span>...Truncated...<span class="o">]</span></code></pre></div>

<p>You will now have a folder that should start with <strong>_DVRF</strong> which contains all of the necessary files for these exercises. So go ahead and change directory to <strong>_DVRF_v01.bin.extracted/squashfs-root/</strong> and perform the following.</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF/_DVRF_v01.bin.extracted/squashfs-root <span class="nv">$ </span>cp <span class="sb">`</span>which qemu-mipsel-static<span class="sb">`</span> ./
b1ack0wl@b1ack0wl-VM ~/DVRF/_DVRF_v01.bin.extracted/squashfs-root <span class="nv">$ </span>ls
bin  etc  media  proc     qemu-mipsel-static  sys  usr  www
dev  lib  mnt    pwnable  sbin                tmp  var
b1ack0wl@b1ack0wl-VM ~/DVRF/_DVRF_v01.bin.extracted/squashfs-root <span class="err">$</span></code></pre></div>

<p>We need to have the statically built Qemu instance on our squash-fs root directory since we are going to chroot the environment when emulating the binaries. So we’re pretty much ready to get started! Let’s go ahead and test out our environment by performing the following command: <strong>sudo chroot &lt;current directory&gt; &lt;qemu-mipsel-static&gt; &lt;path to binary to emulate&gt; argv[1]</strong></p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF/_DVRF_v01.bin.extracted/squashfs-root <span class="nv">$ </span>sudo chroot . ./qemu-mipsel-static ./pwnable/Intro/stack_bof_01 test123
Welcome to the first BoF exercise!

You entered test123
Try Again</code></pre></div>

<p>Awesome!! We can execute the binary without any issues! Now for the last step we need to debug the application and we will use qemu again but we will feed it the <strong>-g</strong> argument which will attach a gdbserver instance to it but won’t execute the binary until an attached gdb instance initiates the continue instruction.</p>

<p>First get two terminals open and in one terminal type in the following command: <strong>sudo chroot . ./qemu-mipsel-static -g 1234 ./pwnable/Intro/stack_bof_01 test123</strong> Remember -g 1234 means that gdbserver is going to start listening on port 1234. Now in the other terminal window you’ll want to use the crossed compiled gdb that’s located within the buildroot output folder.</p>

<p>You should now be at this step:</p>

<p><img src="http://b1ack0wl.com/assets/img/dvrf-gdbserver.jpg" alt="gdbserver" /></p>

<p>Just for fun you can even disassemble the file using the objdump we compiled with option <strong>-D</strong></p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF/buildroot-2015.11.1/output/host/usr/bin <span class="nv">$ </span>./mipsel-buildroot-linux-uclibc-objdump -D ~/DVRF/_DVRF_v01.bin.extracted/squashfs-root/pwnable/Intro/stack_bof_01 <span class="p">|</span> more

/home/b1ack0wl/DVRF/_DVRF_v01.bin.extracted/squashfs-root/pwnable/Intro/stack_bof_01:     file f
ormat elf32-tradlittlemips


Disassembly of section .interp:

004000f4 &lt;.interp&gt;:
  4000f4:	62696c2f 	0x62696c2f
  4000f8:	2d646c2f 	sltiu	a0,t3,27695
  4000fc:	696c4375 	0x696c4375
  400100:	732e6362 	0x732e6362
  400104:	00302e6f 	0x302e6f

Disassembly of section .reginfo:

<span class="m">00400108</span> &lt;.reginfo&gt;:
  400108:	b20001f6 	0xb20001f6
	...
  40011c:	00448ce0 	0x448ce0

Disassembly of section .dynamic:

<span class="m">00400120</span> &lt;_DYNAMIC&gt;:
  400120:	<span class="m">00000001</span> 	movf	zero,zero,<span class="nv">$fcc0</span>
  400124:	<span class="m">00000083</span> 	sra	zero,zero,0x2
  400128:	<span class="m">00000001</span> 	movf	zero,zero,<span class="nv">$fcc0</span>
  40012c:	000000ac 	0xac
  400130:	0000000c 	syscall
  400134:	0040059c 	0x40059c
<span class="o">[</span>...Truncated...<span class="o">]</span>

004007e0 &lt;main&gt;:
  4007e0:	3c1c0005 	lui	gp,0x5
  4007e4:	279c8500 	addiu	gp,gp,-31488
  4007e8:	0399e021 	addu	gp,gp,t9
  4007ec:	27bdff18 	addiu	sp,sp,-232
  4007f0:	afbf00e4 	sw	ra,228<span class="o">(</span>sp<span class="o">)</span>
  4007f4:	afbe00e0 	sw	s8,224<span class="o">(</span>sp<span class="o">)</span>
  4007f8:	03a0f021 	move	s8,sp
  4007fc:	afbc0010 	sw	gp,16<span class="o">(</span>sp<span class="o">)</span>
  400800:	afc400e8 	sw	a0,232<span class="o">(</span>s8<span class="o">)</span>
  400804:	afc500ec 	sw	a1,236<span class="o">(</span>s8<span class="o">)</span>
  400808:	8f82801c 	lw	v0,-32740<span class="o">(</span>gp<span class="o">)</span>
  40080c:	<span class="m">00000000</span> 	nop
  400810:	94420b98 	lhu	v0,2968<span class="o">(</span>v0<span class="o">)</span>
  400814:	<span class="m">00000000</span> 	nop
  400818:	a7c20018 	sh	v0,24<span class="o">(</span>s8<span class="o">)</span>
  40081c:	27c2001a 	addiu	v0,s8,26
  400820:	240300c6 	li	v1,198
  400824:	<span class="m">00402021</span> 	move	a0,v0
  400828:	<span class="m">00002821</span> 	move	a1,zero
  40082c:	<span class="m">00603021</span> 	move	a2,v1
  400830:	8f998040 	lw	t9,-32704<span class="o">(</span>gp<span class="o">)</span>
  400834:	<span class="m">00000000</span> 	nop
  400838:	0320f809 	jalr	t9
  40083c:	<span class="m">00000000</span> 	nop
  400840:	8fdc0010 	lw	gp,16<span class="o">(</span>s8<span class="o">)</span>
  400844:	8fc200e8 	lw	v0,232<span class="o">(</span>s8<span class="o">)</span>
  <span class="o">[</span>...Truncated...<span class="o">]</span>

  <span class="m">00400950</span> &lt;dat_shell&gt;:
  400950:	3c1c0005 	lui	gp,0x5
  400954:	279c8390 	addiu	gp,gp,-31856
  400958:	0399e021 	addu	gp,gp,t9
  40095c:	27bdffe0 	addiu	sp,sp,-32
  400960:	afbf001c 	sw	ra,28<span class="o">(</span>sp<span class="o">)</span>
  400964:	afbe0018 	sw	s8,24<span class="o">(</span>sp<span class="o">)</span>
  400968:	03a0f021 	move	s8,sp
  40096c:	afbc0010 	sw	gp,16<span class="o">(</span>sp<span class="o">)</span>
  400970:	8f82801c 	lw	v0,-32740<span class="o">(</span>gp<span class="o">)</span>
  400974:	<span class="m">00000000</span> 	nop
  400978:	24440c60 	addiu	a0,v0,3168
  40097c:	8f998050 	lw	t9,-32688<span class="o">(</span>gp<span class="o">)</span>
  400980:	<span class="m">00000000</span> 	nop
  400984:	0320f809 	jalr	t9
  400988:	<span class="m">00000000</span> 	nop
  40098c:	8fdc0010 	lw	gp,16<span class="o">(</span>s8<span class="o">)</span>
  400990:	<span class="m">00000000</span> 	nop
  400994:	8f82801c 	lw	v0,-32740<span class="o">(</span>gp<span class="o">)</span>
  400998:	<span class="m">00000000</span> 	nop
  40099c:	24440c94 	addiu	a0,v0,3220
<span class="o">[</span>...Truncated...<span class="o">]</span></code></pre></div>

<p>So all we need to do to solve this is change the return pointer to function <strong>&lt;dat_shell&gt;</strong> which is located at <strong>0x00400950</strong> remember this is little endian and we cannot use NULL bytes but once you get the picture you should just about have the following:</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">b1ack0wl@b1ack0wl-VM ~/DVRF/_DVRF_v01.bin.extracted/squashfs-root <span class="nv">$ </span>sudo chroot . ./qemu-mipsel-static  ./pwnable/Intro/stack_bof_01 <span class="s2">&quot;[REDACTED]&quot;</span>
Welcome to the first BoF exercise!

You entered <span class="o">[</span>REDACTED<span class="o">]</span>
Try Again
Congrats! I will now execute /bin/sh
- b1ack0wl
qemu: uncaught target signal <span class="m">11</span> <span class="o">(</span>Segmentation fault<span class="o">)</span> - core dumped</code></pre></div>

<p>You can see the <strong>Segmentation Fault</strong> which is due to a pointer within the stack being corrupted during the overflow. Your goal is to make this program not segfault so use the tools I provided and make sure to use breakpoints! To get you started here is a proof of concept:</p>

<p><img src="http://b1ack0wl.com/assets/img/dvrf-PoC.jpg" alt="PoC" /></p>

<p>I hope this has helped you get started into your journey into embedded device exploitation. If you have any questions feel free to find me on twitter at <a href="https://twitter.com/b1ack0wl">@b1ack0wl</a></p>

<center>
<b>**DVRF v0.1 has been released on <a href="https://github.com/praetorian-inc/DVRF">GitHub!!</a>** </b> </center>
<p><br /></p>

            </div>
        </article>
        <div class="cf"></div>
        <div class="row text-center">
            <section class="notepad-post-share">
                <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Getting Started with DVRF&quot;%20http://b1ack0wl.com/projects/2016/01/20/Getting-Started-With-DVRF/%20via%20&#64;b1ack0wl"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=http://b1ack0wl.com/projects/2016/01/20/Getting-Started-With-DVRF/"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="google-icon" href="https://plus.google.com/share?url=http://b1ack0wl.com/projects/2016/01/20/Getting-Started-With-DVRF/"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
                    <i class="fa fa-google-plus"></i>
                </a>
            </section>
        </div>
        <div class="cf"></div>

    <footer class="notepad-site-footer">
    <div class="copyright">
        <section>All content copyright <a href="http://b1ack0wl.com/about">b1ack0wl</a> &copy; 2016 &bull; All rights reserved.</section>
    </div>
    <div class="social-icons">

        
        <a href="http://twitter.com/b1ack0wl">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://github.com/b1ack0wl">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
    </div>

    <div class="cf"></div>
</footer>

</main>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="http://b1ack0wl.com/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
    <script src="http://b1ack0wl.com/assets/js/vendor/modernizr.js"></script>
    <script src="http://b1ack0wl.com/assets/js/foundation.min.js"></script>
    
    <script src="http://b1ack0wl.com/assets/js/notepad.js"></script>
    <script src="http://b1ack0wl.com/assets/js/scripts.min.js"></script>
    <script src="http://b1ack0wl.com/assets/js/vendor/nprogress.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/sigma.js/1.0.3/sigma.min.js"></script>

    <script>
      $(document).foundation();
    </script>

<script>NProgress.start();var interval=setInterval(function(){NProgress.inc()},1000);jQuery(window).load(function(){clearInterval(interval);NProgress.done()});jQuery(window).unload(function(){NProgress.start()});</script>

</body>
</html>
